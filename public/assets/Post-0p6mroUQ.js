import{r as i,g as v,h as b,j as e,c as N,s as y,L as _,t as C,n as w,v as P}from"./index-DcZMDsWX.js";import{n as D}from"./noimage-y3vxIS37.js";import{p as S,c as k}from"./Reducers-FdYVeQEV.js";import E from"./PostBody-DVhFKtPO.js";import{P as h}from"./Popup-bydbHcy1.js";import"./react-markdown-Bh_9KXKW.js";/* empty css              */import"./a11y-dark-upxbRWMY.js";function $(n){var u;const[t,r]=i.useReducer(S,n.location.state??{loading:!0,id:null}),[o,c]=i.useState(!0),[a,d]=i.useState({post_title:"",post_body:"",post_image:"",post_status:0}),[x,g]=i.useState([]),[j,p]=i.useState(!1),f=v().post;return i.useEffect(()=>{b(f,r).then(s=>{let l=[];s.tags.map(m=>l.push(m.tag)),console.log(a),g(l),d({...a,post_body:t.post_body,post_title:t.post_title,post_status:parseInt(t.post_status),post_image:t.post_image??""}),c(!1)}),document.title=((t==null?void 0:t.post_title)??window.location.pathname.split("/admin/posts/")[1].split("-").map(s=>s[0].toUpperCase()+s.slice(1)).join(" "))+" | Admin | Codeunlock.in"},[]),e.jsxs("div",{className:"post-edit",children:[e.jsxs("div",{className:"popup",children:[(t==null?void 0:t.error)&&e.jsx(h,{msg:t==null?void 0:t.error,type:"error"}),(t==null?void 0:t.message)&&e.jsx(h,{message:t==null?void 0:t.message,type:"success"})]}),j&&e.jsx(L,{post:a,toggle:p}),o?e.jsx(N,{}):e.jsxs("form",{className:"post-form",onSubmit:async s=>{s.preventDefault();const l=[];document.querySelectorAll(".post_tags").forEach(m=>l.push(m.value)),await y(t.id,{...a,tags:l},r)},children:[e.jsxs("div",{className:"form-header",style:{flexDirection:"row",justifyContent:"space-between"},children:[e.jsx("button",{className:"form-button",children:"UPDATE"}),e.jsx("div",{className:"form-heading",children:"POST"}),e.jsx(_,{to:"/admin/posts",children:e.jsx("button",{className:"form-button unactive-button",children:"BACK"})})]}),e.jsxs("div",{className:"admin-post-top",children:[e.jsxs("div",{className:"admin-post-top-left",children:[e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"form-label",children:"Title"}),e.jsx("input",{type:"text",value:a.post_title,name:"post_title",id:"title",onChange:s=>d({...a,post_title:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{name:"post_status",id:"post_status",onChange:s=>d({...a,post_status:parseInt(s.target.value)}),required:!0,children:[e.jsx("option",{value:"0",defaultValue:parseInt(a.post_status)===0,selected:parseInt(a.post_status)===0,children:"Draft"}),e.jsx("option",{value:"1",defaultValue:parseInt(a.post_status)===1,selected:parseInt(a.post_status)===1,children:"Published"})]})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"form-label",children:"Image (Add Drive link where the image is stored)"}),e.jsx("input",{type:"text",value:(a==null?void 0:a.post_image)??"https://drive.google.com/uc?export=view&id=",onChange:s=>d({...a,post_image:s.target.value})})]})]}),e.jsx("div",{className:"admin-post-top-right",children:e.jsx("img",{src:a.post_image,onError:s=>s.target.src=D,id:"post_image",width:"200",height:"200",alt:"Post Cover"})})]}),e.jsxs("div",{className:"form-input",children:[e.jsxs("label",{className:"form-label",style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Body"}),e.jsxs("div",{style:{display:"flex"},children:[e.jsx("div",{onClick:()=>p(!0),children:"Preview"}),e.jsx("div",{className:"words-count",style:{marginLeft:"10px",color:"grey",fontStyle:"italic",fontSize:"15px"},children:`${((u=t==null?void 0:t.post_body)==null?void 0:u.split(" ").length)??0} words`})]})]}),e.jsx("textarea",{type:"text",rows:"40",value:a.post_body,name:"post_body",id:"post_body",onChange:s=>d({...a,post_body:s.target.value}),required:!0})]}),e.jsxs("div",{className:"form-input",children:[e.jsx("label",{className:"form-label",children:"Tags"}),e.jsx("div",{className:"tags-list",children:x.map((s,l)=>e.jsx("input",{type:"text",value:s,name:`tags${l}`,id:`tags${l}`,onChange:()=>{},className:"post_tags",required:!0},l))}),e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"form-button",onClick:s=>{s.preventDefault();let l=document.createElement("INPUT");l.className="post_tags",document.querySelector(".tags-list").appendChild(l)},children:"ADD"}),e.jsx("button",{className:"form-button unactive-button",onClick:s=>{s.preventDefault();let l=document.querySelector(".tags-list");l.removeChild(l.lastElementChild)},children:"REMOVE"})]})]}),e.jsxs("div",{className:"all-comments form-input",children:[e.jsx("div",{className:"heading",style:{marginBottom:"10px"},children:"Comments"}),e.jsx(I,{postId:t.id})]})]})]})}const I=({postId:n})=>{const[t,r]=i.useReducer(k,[]);return i.useEffect(()=>{C(n,r)},[n]),t.length===0?e.jsx("div",{children:"No comments available"}):e.jsxs("table",{className:"table",style:{overflowX:"auto"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"table-col-heading",children:"Id"}),e.jsx("th",{className:"table-col-heading",children:"User"}),e.jsx("th",{className:"table-col-heading",children:"Comment"}),e.jsx("th",{className:"table-col-heading",children:"Likes"}),e.jsx("th",{className:"table-col-heading",children:"Date"}),e.jsx("th",{className:"table-col-heading",children:"Delete"})]})}),e.jsx("tbody",{children:t.map((o,c)=>e.jsxs("tr",{className:"post-row",style:{overflowX:"scroll"},children:[e.jsx("td",{children:o.id}),e.jsx("td",{children:o.user.name}),e.jsx("td",{children:o.comment_body}),e.jsx("td",{children:o.comment_likes}),e.jsx("td",{children:w(o.created_at)}),e.jsx("td",{onClick:()=>P(n,o.id,r),children:"Delete"})]},c))})]})},L=({post:n,toggle:t})=>{const r={position:"fixed",top:"50px",bottom:"50px",left:"5%",margin:"25px 0",display:"flex",flexDirection:"column",zIndex:"100",backgroundColor:"white",border:"1px solid black",overflowY:"scroll",width:"90vw"};return e.jsxs("div",{style:r,children:[e.jsx("button",{style:{position:"absolute",right:"0",top:"5px"},className:"form-button unactive-button",onClick:()=>t(!1),children:"CLOSE"}),e.jsx("div",{style:{marginTop:"250px"},children:e.jsx(E,{post:n})})]})};export{L as Preview,$ as default};
