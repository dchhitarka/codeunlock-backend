import{r as a,U as x,u as v,j as e,L as l,n as N,o as w}from"./index-DcZMDsWX.js";import{R as _}from"./react-markdown-Bh_9KXKW.js";/* empty css              */import{n as p}from"./noimage-y3vxIS37.js";import{p as $}from"./Reducers-FdYVeQEV.js";import{P as E}from"./Popup-bydbHcy1.js";function T({post:t,index:r}){const i=a.useContext(x).user,[P,h]=a.useReducer($,{}),[k,g]=a.useState(void 0),[b,u]=a.useState(()=>window.innerWidth<=767?125:175),[n,c]=a.useState({like:!1,bookmark:!1});a.useEffect(()=>{if(i.isAuthenticated){let s=t.post_engagements.find(o=>parseInt(o.user_id)===parseInt(i.id));s&&c({...n,like:parseInt(s.like),bookmark:parseInt(s.bookmark)})}},[t.post_engagements]);let f=v();const m={pathname:`/posts/${t.post_slug}`,state:{...t}},y=s=>s.length>60?60:0;a.useEffect(()=>{const s=()=>{window.innerWidth<=600?u(100):u(200)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]);const j=["red","indigo","blue","green","yellow","orange","violet"];return e.jsxs(e.Fragment,{children:[k&&e.jsx(E,{message:k??"Testing",type:"success"}),e.jsxs("div",{className:"post-card",children:[e.jsx(l,{to:m,children:e.jsx("img",{className:"post-img",loading:"lazy",onError:s=>s.target.src=p,src:t.post_image??p,alt:""})}),e.jsxs("div",{className:"post-data",children:[e.jsx(l,{to:m,className:"post-title-link",children:e.jsx("div",{className:"post-title",children:t.post_title})}),e.jsx(l,{to:m,className:"post-content-link",children:e.jsx(_,{className:"post-content",children:`${t.post_body.substring(0,b-y(t.post_title))}...`,skipHtml:!0})}),e.jsxs("div",{className:"post-tags",children:[t.tags.slice(0,2).map((s,o)=>e.jsx(l,{to:`/tags/${s.tag_slug}`,children:e.jsx("span",{className:"post-tag",onMouseOver:d=>d.target.style.opacity="0.8",onMouseLeave:d=>d.target.style.opacity="1",style:{backgroundColor:j[o]},children:`#${s.tag}`},o)},o)),t.tags.length-2>0?e.jsxs("span",{style:{padding:"2px",fontWeight:"bold"},children:["+",t.tags.length-2]}):""]}),e.jsxs("div",{className:"post-meta",children:[e.jsxs("div",{className:"post-date",children:["Published On: ",N(t.published_on)]}),e.jsx("div",{className:"engage-post",children:e.jsx("div",{className:"posts post-bookmark",onClick:()=>{i.isAuthenticated?(document.querySelector(`.bookmark-icon-${r}`).style.transform="scale(0.5, 0.5)",document.querySelector(`.bookmark-icon-${r}`).style.transition="0.1s",setTimeout(()=>{document.querySelector(`.bookmark-icon-${r}`).style.transform="scale(1, 1)"},100),w(h,t.id,i.id,"bookmark").then(s=>{n.bookmark?c(o=>({...o,bookmark:0})):c(o=>({...o,bookmark:1})),g(s.message),setTimeout(()=>g(void 0),2500)})):f.push("/u/login")},children:e.jsx("i",{className:n.bookmark===1||n.bookmark===!0?`fas fa-bookmark bookmark-icon-${r}`:`far fa-bookmark bookmark-icon-${r}`,style:{color:"black"}})})})]})]})]},r)]})}export{T as P};
